# 경로 생성 지연 원인 분석 (코드 기준)

아래 항목들은 `local_bezier`/글로벌 Bézier 생성이 느려질 수 있는 경로를 **비용이 큰 순서**로 정리한 것이다. 각 지점마다 연산량이 커지는 이유와 위치를 함께 적었다.

| 우선순위 | 위치/라인 | 원인 | 설명 |
| --- | --- | --- | --- |
| 1 | `bezier_utils._push_away_from_obstacles` (L104-L167) | Bézier-장애물 겹침 검사 재귀 + 반복 패스 | 각 세그먼트마다 De Casteljau 분할로 충돌 t-구간을 찾고, 구간별로 최대 3점 평가를 최대 14패스 반복한다. 장애물/세그먼트가 많을수록 재귀·반복 비용이 가장 크게 누적된다. |
| 2 | `bezier_utils.generate_bezier_from_waypoints` (L373-L462) | 전 구간 Bézier 체인 생성 + 세그먼트별 충돌 보정 | 모든 세그먼트에 대해 제어점 구성 후 `_push_away_from_obstacles`를 다시 호출한다. 제약/코스트맵이 많거나 세그먼트 수가 길면 1번 병목이 구간마다 반복된다. |
| 3 | `costmap_constraint_filter.build_constraints` (L143-L188) | 경로-코스트맵 전수 거리 계산 | 코스트맵 점마다 `polyline_min_distance`(세그먼트 루프)와 최근접 인덱스 탐색을 수행해 O(N·M) 패턴이 된다. 코스트맵/경로가 길수록 반복 계산이 급증한다. |
| 4 | `path_manager._update_path` (L129-L200) | ds=0.08 고정 샘플링 + 즉시 재생성 | 클릭·토픽·모드 변경 시마다 8cm 간격으로 전 경로를 다시 보간하고 방향 계산을 한다. 베지어/스플라인 모두 점 수가 많아지고, 상위 1~3단계 연산을 다시 호출해 지연이 누적된다. |
| 5 | `path_manager._rrt_bridge_waypoints` + `rrt_planner.plan` (L209-L240, RRT L33-L86) | 세그먼트별 최대 900회 RRT 확장 | `local_bezier`일 때만 쓰이지만, 세그먼트마다 최대 900회 샘플-충돌검사 루프를 돌며 최소 경로를 찾는다. 장애물이 많으면 여러 세그먼트에 대해 반복되어 추가 지연을 만든다. |

## 요약
- **주 원인**은 Bézier 충돌 해소 루프(1,2)와 코스트맵-경로 전수 거리 계산(3)으로, 장애물/코스트맵이 많을 때 계산량이 급증한다.
- 고정된 **8cm 샘플링**과 **세그먼트별 RRT**도 클릭·모드 전환마다 전체 재계산을 유발해 체감 지연을 키운다.
